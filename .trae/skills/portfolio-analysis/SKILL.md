---
name: "portfolio-analysis"
description: "面向持仓的深度分析。用户点击分析或请求持仓洞察时调用，自动抓取实时行情/新闻/财务并进行中文总结与建议。"
---

# 持仓分析 Agent Skill

本 Skill 用于对用户持仓（股票/基金代码）进行自动化深度分析，输出中文结论与建议。适合移动端场景，结合实时行情、新闻与基础财务概览，生成结构化分析报告。

## 何时使用
- 用户点击「分析」按钮
- 用户请求对当前持仓进行洞察、风险提示或操作建议
- 需要基于最新行情与新闻做快速判断

## 能力范围
- 获取实时行情（价格、涨跌幅、交易量等）
- 聚合相关新闻与事件线索（中文优先）
- 基础财务概览（营收、净利等，如数据源可用）
- 将上述信息进行归纳总结，形成中文分析与建议

## 使用方式
1. 后端接口 `POST /api/analyze` 接收 `codes: string[]`
2. Skill 汇总每个代码的：`quote`、`news`、`financials`（如可用）
3. 若配置了 `OPENAI_API_KEY`，则调用模型生成更深入的中文分析；否则输出基于规则的简要分析
4. 返回结构化结果，前端展示

## 输出结构（示例）
```json
{
  "code": "AAPL",
  "quote": { "price": 150.12, "changePct": 2.1 },
  "news": ["标题1", "标题2"],
  "financials": { "revenue": "100B", "netIncome": "25B" },
  "analysis": "综合来看，维持谨慎乐观，关注……"
}
```

## 注意事项
- 优先中文输出；若数据缺失则标注「未知」
- 实时行情与新闻来源可能存在速率/授权限制，请在生产环境配置稳定数据源
- 切勿记录或泄露密钥，所有密钥通过环境变量传入

